bamcoverage_cmd = "bamCoverage -p {threads} --normalizeUsingRPKM -b {input.bam} -o {output[0]}"


rule bamcoverage:
    input:
        bam = "{prefix}/data/bam/{sample}.sorted.bam",
        index = "{prefix}/data/bam/{sample}.sorted.bam.bai"
    output:
        "{prefix}/data/bamcoverage/{sample}.bw"
    threads:
        48
    shell:
        bamcoverage_cmd


rule bamcoverage_merged_group:
    input:
        bam = "{prefix}/data/bamcompare/{group}_{chip}.sorted.bam",
        index = "{prefix}/data/bamcompare/{group}_{chip}.sorted.bam.bai"
    output:
        "{prefix}/data/bamcoverage/merged_{group}_{chip}.bw"
    threads:
        48
    shell:
        bamcoverage_cmd
