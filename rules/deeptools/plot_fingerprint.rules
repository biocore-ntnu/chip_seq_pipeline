
rule plot_fingerprints_individual:
    input:
        bam = expand("{prefix}/data/align/{sample}.bam.sorted", prefix=prefix, sample=ss.Name.drop_duplicates()),
        idx = expand("{prefix}/data/align/{sample}.bam.sorted.bai", prefix=prefix, sample=ss.Name.drop_duplicates())
    output:
        plot = "{prefix}/data/plot_fingerprint/fingerprint_deeptools.pdf",
        raw = "{prefix}/data/plot_fingerprint/fingerprint_deeptools.counts"
    threads:
        48
    shell:
        "plotFingerprint -p {threads} -b {input.bam} --minMappingQuality {config[fastq_quality]} -plot {output.plot} --outRawCounts {output.raw} -T 'Min quality: {config[fastq_quality]}'"
